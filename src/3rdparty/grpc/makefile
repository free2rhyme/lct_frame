
GRPC_LIBRARY_PATH    := $(CURDIR)/lib
SYMBOLIC_FLAGS       := -r -s

LIB_PROTOBUF_SO_FILE := libprotobuf.so.13.0.0
LIB_PROTOBUF_SO_13   := libprotobuf.so.13
LIB_PROTOBUF_SO      := libprotobuf.so

LIB_PROTOC_SO_FILE   := libprotoc.so.13.0.0
LIB_PROTOC_SO_13     := libprotoc.so.13
LIB_PROTOC_SO        := libprotoc.so

LIB_GRPC_REFLECTION_SO_FILE := libgrpc++_reflection.so.1.3.2
LIB_GRPC_REFLECTION_SO      := libgrpc++_reflection.so

LIB_GRPC_PLUS_PLUS_SO_FILE  := libgrpc++.so.1.3.2
LIB_GRPC_PLUS_PLUS_SO_3     := libgrpc++.so.3
LIB_GRPC_PLUS_PLUS_SO_1     := libgrpc++.so.1
LIB_GRPC_PLUS_PLUS_SO       := libgrpc++.so

LIB_GRPC_SO_FILE     := libgrpc.so.3.0.0
LIB_GRPC_SO_3        := libgrpc.so.3
LIB_GRPC_SO          := libgrpc.so

LIB_GRP_SO_FILE      := libgpr.so.3.0.0
LIB_GRP_SO_3         := libgpr.so.3
LIB_GRP_SO           := libgpr.so

FIXED_LIB_PROTOBUF_SO_FILE := $(GRPC_LIBRARY_PATH)/$(LIB_PROTOBUF_SO_FILE)
FIXED_LIB_PROTOBUF_SO_13   := $(GRPC_LIBRARY_PATH)/$(LIB_PROTOBUF_SO_13)
FIXED_LIB_PROTOBUF_SO      := $(GRPC_LIBRARY_PATH)/$(LIB_PROTOBUF_SO)

FIXED_LIB_PROTOC_SO_FILE   := $(GRPC_LIBRARY_PATH)/$(LIB_PROTOC_SO_FILE)
FIXED_LIB_PROTOC_SO_13     := $(GRPC_LIBRARY_PATH)/$(LIB_PROTOC_SO_13)
FIXED_LIB_PROTOC_SO        := $(GRPC_LIBRARY_PATH)/$(LIB_PROTOC_SO)

FIXED_LIB_GRPC_REFLECTION_SO_FILE := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_REFLECTION_SO_FILE)
FIXED_LIB_GRPC_REFLECTION_SO      := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_REFLECTION_SO)

FIXED_LIB_GRPC_PLUS_PLUS_SO_FILE  := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_PLUS_PLUS_SO_FILE)
FIXED_LIB_GRPC_PLUS_PLUS_SO_3     := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_PLUS_PLUS_SO_3)
FIXED_LIB_GRPC_PLUS_PLUS_SO_1     := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_PLUS_PLUS_SO_1)
FIXED_LIB_GRPC_PLUS_PLUS_SO       := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_PLUS_PLUS_SO)

FIXED_LIB_GRPC_SO_FILE    := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_SO_FILE)
FIXED_LIB_GRPC_SO_3       := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_SO_3)
FIXED_LIB_GRPC_SO         := $(GRPC_LIBRARY_PATH)/$(LIB_GRPC_SO)

FIXED_LIB_GRP_SO_FILE     := $(GRPC_LIBRARY_PATH)/$(LIB_GRP_SO_FILE)
FIXED_LIB_GRP_SO_3        := $(GRPC_LIBRARY_PATH)/$(LIB_GRP_SO_3)
FIXED_LIB_GRP_SO          := $(GRPC_LIBRARY_PATH)/$(LIB_GRP_SO)


all debug release build:
	@echo "Start building $@"

ifneq ($(FIXED_LIB_PROTOBUF_SO_13), $(wildcard $(FIXED_LIB_PROTOBUF_SO_13)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_PROTOBUF_SO_FILE) $(FIXED_LIB_PROTOBUF_SO_13)
endif

ifneq ($(FIXED_LIB_PROTOBUF_SO), $(wildcard $(FIXED_LIB_PROTOBUF_SO)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_PROTOBUF_SO_FILE) $(FIXED_LIB_PROTOBUF_SO)
endif

ifneq ($(FIXED_LIB_PROTOC_SO_13), $(wildcard $(FIXED_LIB_PROTOC_SO_13)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_PROTOC_SO_FILE) $(FIXED_LIB_PROTOC_SO_13)
endif

ifneq ($(FIXED_LIB_PROTOC_SO), $(wildcard $(FIXED_LIB_PROTOC_SO)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_PROTOC_SO_FILE) $(FIXED_LIB_PROTOC_SO)
endif

ifneq ($(FIXED_LIB_GRPC_REFLECTION_SO), $(wildcard $(FIXED_LIB_GRPC_REFLECTION_SO)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRPC_REFLECTION_SO_FILE) $(FIXED_LIB_GRPC_REFLECTION_SO)
endif

ifneq ($(FIXED_LIB_GRPC_PLUS_PLUS_SO_3), $(wildcard $(FIXED_LIB_GRPC_PLUS_PLUS_SO_3)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRPC_PLUS_PLUS_SO_FILE) $(FIXED_LIB_GRPC_PLUS_PLUS_SO_3)
endif

ifneq ($(FIXED_LIB_GRPC_PLUS_PLUS_SO_1), $(wildcard $(FIXED_LIB_GRPC_PLUS_PLUS_SO_1)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRPC_PLUS_PLUS_SO_FILE) $(FIXED_LIB_GRPC_PLUS_PLUS_SO_1)
endif

ifneq ($(FIXED_LIB_GRPC_PLUS_PLUS_SO), $(wildcard $(FIXED_LIB_GRPC_PLUS_PLUS_SO)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRPC_PLUS_PLUS_SO_FILE) $(FIXED_LIB_GRPC_PLUS_PLUS_SO)
endif

ifneq ($(FIXED_LIB_GRPC_SO_3), $(wildcard $(FIXED_LIB_GRPC_SO_3)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRPC_SO_FILE) $(FIXED_LIB_GRPC_SO_3)
endif

ifneq ($(FIXED_LIB_GRPC_SO), $(wildcard $(FIXED_LIB_GRPC_SO)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRPC_SO_FILE) $(FIXED_LIB_GRPC_SO)
endif

ifneq ($(FIXED_LIB_GRP_SO_3), $(wildcard $(FIXED_LIB_GRP_SO_3)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRP_SO_FILE) $(FIXED_LIB_GRP_SO_3)
endif

ifneq ($(FIXED_LIB_GRP_SO), $(wildcard $(FIXED_LIB_GRP_SO)))
	ln $(SYMBOLIC_FLAGS) $(FIXED_LIB_GRP_SO_FILE) $(FIXED_LIB_GRP_SO)
endif
	@echo "Finished building $@"

clean:
	rm -f $(FIXED_LIB_PROTOBUF_SO_13)
	rm -f $(FIXED_LIB_PROTOBUF_SO)
	rm -f $(FIXED_LIB_PROTOC_SO_13)
	rm -f $(FIXED_LIB_PROTOC_SO)
	rm -f $(FIXED_LIB_GRPC_REFLECTION_SO)
	rm -f $(FIXED_LIB_GRPC_PLUS_PLUS_SO_3)
	rm -f $(FIXED_LIB_GRPC_PLUS_PLUS_SO_1)
	rm -f $(FIXED_LIB_GRPC_PLUS_PLUS_SO)
	rm -f $(FIXED_LIB_GRPC_SO_3)
	rm -f $(FIXED_LIB_GRPC_SO)
	rm -f $(FIXED_LIB_GRP_SO_3)
	rm -f $(FIXED_LIB_GRP_SO)
	@echo " "

rebuild: build

.PHONY:clean rebuild



